---
title: "Precision ixture modelling in R"
author: "Ed Berry"
date: "31 August 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE)
```

Translation of Paul Bays' Matlab functions for mixture modelling into R. Bays' guide to the function and their usage can be found here. All the function names are the same as the Matlab function. The code is also as close as possible to the Matlab code 'under the hood'.

## Estimating Bias and Precision

If we want to calculate bias (central tendency) or precision (inverse SD) all you need to do is call

```r{}
JV10_error(X, Tg)
```

Where X is a vector of responses and T is a vector of targets. Importantly these inputs must be in the range -$\pi$ to $\pi$. To get your degrees to this range use the `wrap` function. `JV10_error` return a `dataframe` with two columns `P` for the precision value and `B` for the bias value. If the vector of target orientations isn't included then it defaults to 0. 

## Mixture modelling

To do the mixture modelling described in Bayes et al. 2009 you call `JV10_fit(X, Tg, NT, return.ll)`. This function has two required argument and two optional argument. The required arguments are `X` (a vector of response orientations) and `Tg` (a vector of target orientation). `NT` is the orientation(s) on your non-target items and should be a vector/matrix with the same number of rows as X and Tg. Clearly the first rows of X, Tg, and NT should be the single trial, and so on. `return.ll` is a logical argument for whether you want the loglikelihood of the final estimates to be returns. `return.ll` defaults to true meaning that `JV10_fit` will return a list containing `B` (a dataframe of parameter estimates) and `LL` the log-likelihood. If `return.ll = FALSE` then you'll just get the dataframe `B` back.

### Working with a dataframe

I've written a function JV10_df for cases where you want to apply the mixture modelling to a dataframe.

```r{}
estimates <- JV10_df(df, id.var = "id", tar.var = "target", res.var = "response", nt.vars = NULL)
```
The `df` argument is your dataframe. `id.var` is the name of the column that contains a factor that you want to estimate the parameters for each level of. `tar.var` is the name of your target column and `res.var` is the name of your response variable. Use `nt.vars` if you have non-targets. This can either be a single column or a set of columns, e.g. `c("nt1", "nt2")`. You don't get the logliklihood back here but I may update this at some point. 
